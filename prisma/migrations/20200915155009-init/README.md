# Migration `20200915155009-init`

This migration has been generated by svirins at 9/15/2020, 6:50:09 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."WeekdayEnum" AS ENUM ('Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa', 'Su')

CREATE TYPE "public"."MeetingEnum" AS ENUM ('Open', 'Closed', 'Speaker', 'TwelveSteps', 'Reflections')

CREATE TYPE "public"."RegionEnum" AS ENUM ('All', 'Minskaya', 'Brestskaya', 'Gomelskaya', 'Mogilevskaya', 'Grodnenskaya', 'Vitebskaya')

CREATE TABLE "public"."User" (
"id" SERIAL,
"name" text   NOT NULL ,
"email" text   NOT NULL ,
"password" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Group" (
"id" SERIAL,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"birthday" timestamp(3)   NOT NULL ,
"authorId" integer   NOT NULL ,
"name" text   NOT NULL DEFAULT E'New AA Group',
"description" text   NOT NULL DEFAULT E'Blah-blah-blah',
"city" text   NOT NULL ,
"region" "RegionEnum"  NOT NULL ,
"isActive" boolean   NOT NULL DEFAULT true,
"phone" text   NOT NULL ,
"email" text   NOT NULL ,
"address" text   NOT NULL ,
"website" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Meeting" (
"id" SERIAL,
"groupId" integer   NOT NULL ,
"name" text   NOT NULL DEFAULT E'New AA Meeting',
"weekday" "WeekdayEnum"  NOT NULL ,
"time" timestamp(3)   NOT NULL ,
"model" "MeetingEnum"  NOT NULL DEFAULT E'Closed',
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Event" (
"id" SERIAL,
"authorId" integer   NOT NULL ,
"name" text   NOT NULL ,
"dateStart" timestamp(3)   NOT NULL ,
"dateEnd" timestamp(3)   NOT NULL ,
"city" text   NOT NULL ,
"address" text   NOT NULL ,
"description" text   NOT NULL ,
"agenda" text   NOT NULL ,
"programUrl" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Location" (
"id" SERIAL,
"GroupId" integer   NOT NULL ,
"EventId" integer   NOT NULL ,
"lattitude" Decimal(65,30)   NOT NULL ,
"longitude" Decimal(65,30)   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Image" (
"id" SERIAL,
"EventId" integer   NOT NULL ,
"publicId" text   NOT NULL ,
"cloudinaryUrl" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Contact" (
"id" SERIAL,
"EventId" integer   NOT NULL ,
"name" text   NOT NULL ,
"phone" text   NOT NULL ,
"responsibility" text   NOT NULL DEFAULT E'Координатор',
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.name_unique" ON "public"."User"("name")

CREATE UNIQUE INDEX "User.email_unique" ON "public"."User"("email")

CREATE UNIQUE INDEX "User.password_unique" ON "public"."User"("password")

CREATE UNIQUE INDEX "Location_GroupId_unique" ON "public"."Location"("GroupId")

CREATE UNIQUE INDEX "Location_EventId_unique" ON "public"."Location"("EventId")

CREATE UNIQUE INDEX "Image_EventId_unique" ON "public"."Image"("EventId")

ALTER TABLE "public"."Group" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Meeting" ADD FOREIGN KEY ("groupId")REFERENCES "public"."Group"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Event" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Location" ADD FOREIGN KEY ("GroupId")REFERENCES "public"."Group"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Location" ADD FOREIGN KEY ("EventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Image" ADD FOREIGN KEY ("EventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Contact" ADD FOREIGN KEY ("EventId")REFERENCES "public"."Event"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200915155009-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,118 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model User {
+  id           Int             @id @default(autoincrement())
+  name         String          @unique
+  email        String          @unique
+  password     String          @unique 
+  groups       Group[]         
+  events       Event[]         
+}
+
+model Group {
+  id               Int          @id @default(autoincrement()) 
+  createdAt        DateTime     @default(now())
+  birthday         DateTime     
+  author           User         @relation(fields: [authorId], references: [id])
+  authorId         Int
+  name             String       @default("New AA Group")
+  description      String       @default("Blah-blah-blah")
+  city             String
+  region           RegionEnum
+  isActive         Boolean      @default(true)
+  phone            String
+  email            String
+  address          String
+  website          String
+  location         Location
+  meetings         Meeting[]    
+}
+
+model Meeting  {
+  id               Int          @id @default(autoincrement()) 
+  group            Group        @relation(fields: [groupId], references: [id])
+  groupId          Int 
+  name             String       @default("New AA Meeting")
+  weekday          WeekdayEnum
+  time             DateTime 
+  model            MeetingEnum  @default(Closed)
+} 
+
+model Event {
+  id               Int         @id @default(autoincrement()) 
+  author           User        @relation(fields: [authorId], references: [id])
+  authorId         Int
+  name             String       
+  dateStart        DateTime
+  dateEnd          DateTime
+  city             String
+  location         Location
+  address          String  
+  description      String       
+  agenda           String        
+  contact          Contact[]     
+  image            Image
+  programUrl       String
+}
+
+model Location {
+  id               Int          @id @default(autoincrement()) 
+  GroupRel         Group        @relation(fields: [GroupId], references: [id])
+  GroupId          Int
+  EventRel         Event        @relation(fields: [EventId], references: [id])
+  EventId          Int
+  lattitude        Float
+  longitude        Float
+}  
+
+model Image {
+  id               Int          @id @default(autoincrement())
+  EventRel         Event        @relation(fields: [EventId], references: [id])
+  EventId          Int
+  publicId         String      
+  cloudinaryUrl    String       
+}
+
+model Contact {
+  id               Int          @id @default(autoincrement()) 
+  EventRel         Event        @relation(fields: [EventId], references: [id])
+  EventId          Int
+  name             String
+  phone            String
+  responsibility   String       @default("Координатор")
+}
+
+enum WeekdayEnum {
+  Mo
+  Tu
+  We
+  Th
+  Fr
+  Sa
+  Su
+}
+
+enum MeetingEnum {
+  Open
+  Closed 
+  Speaker
+  TwelveSteps
+  Reflections
+}
+
+enum RegionEnum {
+  All
+  Minskaya
+  Brestskaya
+  Gomelskaya
+  Mogilevskaya
+  Grodnenskaya
+  Vitebskaya
+}
```


